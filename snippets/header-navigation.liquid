{%- comment -%}
  ==========================================
  ðŸ§­ HEADER NAVIGATION COMPONENT
  ==========================================
  Clean, accessible navigation with dropdown support
  
  Parameters:
  - menu_handle: Menu handle to render
  - enable_dropdowns: Enable dropdown functionality
  - dropdown_style: Style variant for dropdowns
{%- endcomment -%}

{%- liquid
  assign menu = linklists[menu_handle]
  assign enable_drops = enable_dropdowns | default: true
  assign drop_style = dropdown_style | default: 'styled'
-%}

{%- if menu.links.size > 0 -%}
  <ul class="header-nav" role="list">
    {%- for link in menu.links -%}
      <li class="header-nav__item">
        {%- if link.links.size > 0 and enable_drops -%}
          {%- comment -%} Menu item with dropdown {%- endcomment -%}
          <details class="header-nav__dropdown" id="header-menu-{{ forloop.index }}">
            <summary class="header-nav__link header-nav__link--dropdown" 
                     aria-expanded="false"
                     {% if link.child_active %}aria-current="true"{% endif %}>
              <span class="header-nav__text{% if link.child_active %} header-nav__text--active{% endif %}">
                {{ link.title | escape }}
              </span>
              <svg class="header-nav__caret" width="12" height="8" viewBox="0 0 12 8" fill="none" aria-hidden="true">
                <path d="M1 1.5L6 6.5L11 1.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </summary>
            
            <ul class="header-nav__submenu header-nav__submenu--{{ drop_style }}" role="list">
              {%- for child_link in link.links -%}
                <li class="header-nav__subitem">
                  <a href="{{ child_link.url }}" 
                     class="header-nav__sublink{% if child_link.current %} header-nav__sublink--active{% endif %}"
                     {% if child_link.current %}aria-current="page"{% endif %}>
                    {{ child_link.title | escape }}
                  </a>
                </li>
              {%- endfor -%}
            </ul>
          </details>
        {%- else -%}
          {%- comment -%} Regular menu item {%- endcomment -%}
          <a href="{{ link.url }}" 
             class="header-nav__link{% if link.current %} header-nav__link--active{% endif %}"
             {% if link.current %}aria-current="page"{% endif %}>
            <span class="header-nav__text">{{ link.title | escape }}</span>
          </a>
        {%- endif -%}
      </li>
    {%- endfor -%}
  </ul>
{%- endif -%}