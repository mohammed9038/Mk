<div class="form-horizontal toolbar-sorter sorter">
  <label for="SortBy">{{ 'collections.sorting.title' | t }}</label>
  {% if current_tags %}
  {% assign tagUrl = current_tags | handleize %}
  {% assign tagUrl = tagUrl | prepend: '/' %}
  {% else %}
  {% assign tagUrl = '' %}
  {% endif %}
  {% if collection.handle %}
  {% capture collection_url %}/collections/{{ collection.handle }}{% endcapture %}
  {% comment %}Good for automatic type collections{% endcomment %}
  {% elsif collection.current_type %}
  {% assign collection_url = collection.current_type | url_for_type | sort_by: collection.sort_by  %}
  {% comment %}Good for automatic vendor collections{% endcomment %}
  {% elsif collection.current_vendor %}
  {% assign collection_url = collection.current_vendor | url_for_vendor %}
  {% endif %}
  <a class="hide action-sortby-select" data-role="action-sortby-select" href=''></a>
  <select name="sort_by" id="SortBy" class="btn--tertiary">
  {% for option in collection.sort_options %}
     <option value="{{ option.value }}" {% if collection.handle %}data-herf="{{ collection_url }}{{ tagUrl }}/?sort_by={{ option.value }}"{% elsif collection.current_vendor %}data-herf="{{ collection_url }}&sort_by={{ option.value }}"{% endif %}{% if sort_by == option.value %} selected="selected"{% endif %}>{{ option.name }}</option>
  {% endfor %}
  </select>
</div>

<script>
  // jquery is already running on the site, so we use it to check the document is ready
  $(document).ready(function() {
    // Identify a Select Option from the value in the URL query text
    // Where this exists as an Option Value, add the 'selected' attribute to the Option
    // This ensures that when the page reloads the current option will be showing
    $("#SortBy option[value='{{collection.sort_by}}']").attr('selected', true);
      });
</script>