<!-- 
Menu Selection Verification Test
Copy this HTML into a test page or open directly to verify menu detection.
Replace the Liquid variables with your actual values for testing.
-->

<!DOCTYPE html>
<html>
<head>
    <title>Menu Selection Debug</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug-info { background: #f0f0f0; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .error { background: #ffe6e6; border-left: 4px solid #e74c3c; }
        .success { background: #e6ffe6; border-left: 4px solid #27ae60; }
        .warning { background: #fff3cd; border-left: 4px solid #ffc107; }
        code { background: #f8f8f8; padding: 2px 4px; border-radius: 3px; }
    </style>
</head>
<body>
    <h1>üîç Menu Selection Debug Test</h1>
    
    <div class="debug-info">
        <h3>üìù Instructions:</h3>
        <ol>
            <li>Go to your Shopify admin ‚Üí Online Store ‚Üí Navigation</li>
            <li>Make sure you have at least one menu with items</li>
            <li>Go to Theme Customization ‚Üí Header section</li>
            <li>Select your menu in the "Menu" dropdown</li>
            <li>Save and check your site</li>
        </ol>
    </div>
    
    <div class="debug-info warning">
        <h3>‚ö†Ô∏è Common Issues:</h3>
        <ul>
            <li><strong>Empty Menu:</strong> Your selected menu exists but has no items</li>
            <li><strong>Wrong Handle:</strong> The menu handle doesn't match what's selected</li>
            <li><strong>Menu Deleted:</strong> The selected menu was deleted from Shopify admin</li>
            <li><strong>Cache Issue:</strong> Changes haven't propagated yet (try refreshing)</li>
        </ul>
    </div>
    
    <div class="debug-info">
        <h3>üîß Testing Your Setup:</h3>
        <p>Open browser console and paste this test script:</p>
        <code style="display: block; white-space: pre-wrap; background: #2d3748; color: #fff; padding: 10px;">
// Test script for menu debugging
console.log('üîç Testing Menu Selection...');

// Check if we're seeing test menu items (indicates fallback is active)
const testMenuItems = document.querySelectorAll('span[innerHTML*="Test Menu"], [innerHTML*="(Test Menu)"]');
console.log(`Test menu items found: ${testMenuItems.length}`);

// Check for error messages
const errorMessages = document.querySelectorAll('.menu-error-message');
console.log(`Error messages: ${errorMessages.length}`);

// Check navigation structure
const navMenus = document.querySelectorAll('.header__inline-menu ul');
console.log(`Navigation menus found: ${navMenus.length}`);

// List menu items
const menuItems = document.querySelectorAll('.header__inline-menu li');
console.log(`Menu items found: ${menuItems.length}`);

menuItems.forEach((item, index) => {
    const text = item.textContent.trim();
    const hasDropdown = item.querySelector('details') !== null;
    console.log(`  ${index + 1}. ${text} ${hasDropdown ? '(dropdown)' : '(link)'}`);
});

// Check if NavigationController found the menus
if (window.navigationController) {
    console.log('NavigationController state:', window.navigationController.debugNavigation());
} else {
    console.log('‚ùå NavigationController not loaded');
}

console.log('‚úÖ Menu test complete - check results above');
        </code>
    </div>
    
    <div class="debug-info success">
        <h3>‚úÖ What Should Happen:</h3>
        <ul>
            <li>If menu is properly selected: You'll see your actual menu items</li>
            <li>If menu is empty/missing: You'll see "Menu not found" error message</li>
            <li>If no menu selected: You'll see test menu items with "(Test Menu)" labels</li>
        </ul>
    </div>
    
    <div class="debug-info">
        <h3>üõ†Ô∏è Quick Fixes:</h3>
        <ul>
            <li><strong>Create Menu:</strong> Go to Navigation ‚Üí Create menu ‚Üí Add items</li>
            <li><strong>Select Menu:</strong> Theme Customization ‚Üí Header ‚Üí Menu ‚Üí Select your menu</li>
            <li><strong>Refresh Navigation:</strong> Run <code>window.navigationController.refreshNavigation()</code> in console</li>
            <li><strong>Clear Cache:</strong> Hard refresh (Ctrl+F5) or incognito/private browsing</li>
        </ul>
    </div>
    
    <script>
        // Auto-run basic checks when page loads
        window.addEventListener('load', function() {
            setTimeout(function() {
                console.log('üöÄ Auto-running menu diagnostic...');
                
                const hasNavigation = document.querySelector('.header__inline-menu') !== null;
                const hasMenuItems = document.querySelectorAll('.header__inline-menu li').length > 0;
                const hasTestMenu = document.querySelector('[innerHTML*="Test Menu"]') !== null;
                const hasErrorMsg = document.querySelector('.menu-error-message') !== null;
                
                console.log(`Navigation container: ${hasNavigation ? '‚úÖ' : '‚ùå'}`);
                console.log(`Menu items: ${hasMenuItems ? '‚úÖ' : '‚ùå'}`);
                console.log(`Using test menu: ${hasTestMenu ? '‚ö†Ô∏è Yes' : '‚úÖ No'}`);
                console.log(`Error message: ${hasErrorMsg ? '‚ùå Yes' : '‚úÖ No'}`);
                
                if (hasErrorMsg) {
                    console.log('üí° Solution: Select a menu in theme settings');
                } else if (hasTestMenu) {
                    console.log('üí° Solution: Create menu items or check menu selection');
                } else {
                    console.log('‚úÖ Menu appears to be working correctly!');
                }
            }, 1000);
        });
        
        // Add helper function
        window.quickMenuTest = function() {
            fetch('/menu-selection-diagnostic.js')
                .then(response => response.text())
                .then(script => eval(script))
                .catch(error => {
                    console.log('Manual diagnostic:');
                    
                    const menuItems = document.querySelectorAll('.header__inline-menu li');
                    console.log(`Found ${menuItems.length} menu items:`);
                    
                    menuItems.forEach((item, index) => {
                        const text = item.textContent.trim().substring(0, 50);
                        const hasDropdown = item.querySelector('details') !== null;
                        console.log(`  ${index + 1}. ${text} ${hasDropdown ? '(dropdown)' : '(link)'}`);
                    });
                });
        };
        
        console.log('üí° Run quickMenuTest() for instant menu diagnostic');
    </script>
</body>
</html>
