{%- if section.settings.enable_bottom_nav -%}
<div class="mobile-bottom-nav" role="navigation" aria-label="{{ 'general.navigation.mobile_bottom' | t }}">
  <div class="mobile-bottom-nav__inner">
    
    {%- comment -%} Home {%- endcomment -%}
    <a href="{{ routes.root_url }}" class="mobile-bottom-nav__item {% if request.path == '/' %}mobile-bottom-nav__item--active{% endif %}">
      <svg class="mobile-bottom-nav__icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
        <path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span class="mobile-bottom-nav__label">{{ section.settings.home_label | default: 'Home' }}</span>
    </a>

    {%- comment -%} Search {%- endcomment -%}
    <button class="mobile-bottom-nav__item mobile-bottom-nav__search-trigger" 
            aria-label="{{ 'general.search.search' | t }}"
            data-search-trigger>
      <svg class="mobile-bottom-nav__icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
        <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span class="mobile-bottom-nav__label">{{ section.settings.search_label | default: 'Search' }}</span>
    </button>

    {%- comment -%} Cart {%- endcomment -%}
    <a href="{{ routes.cart_url }}" class="mobile-bottom-nav__item mobile-bottom-nav__cart {% if cart.item_count > 0 %}has-items{% endif %}">
      <svg class="mobile-bottom-nav__icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
        <path d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17M17 13v8a2 2 0 11-4 0 2 2 0 014 0zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span class="mobile-bottom-nav__label">{{ section.settings.cart_label | default: 'Cart' }}</span>
      {%- if cart.item_count > 0 -%}
        <span class="mobile-bottom-nav__badge">{{ cart.item_count }}</span>
      {%- endif -%}
    </a>

    {%- comment -%} Account {%- endcomment -%}
    <a href="{% if customer %}{{ routes.account_url }}{% else %}{{ routes.account_login_url }}{% endif %}" 
       class="mobile-bottom-nav__item {% if request.path contains '/account' %}mobile-bottom-nav__item--active{% endif %}">
      <svg class="mobile-bottom-nav__icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
        <path d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span class="mobile-bottom-nav__label">{{ section.settings.account_label | default: 'Account' }}</span>
    </a>

  </div>

  {%- comment -%} Search Modal {%- endcomment -%}
  <div class="mobile-bottom-nav__search-modal" data-search-modal>
    <div class="mobile-bottom-nav__search-header">
      <button class="mobile-bottom-nav__search-close" data-search-close aria-label="{{ 'general.search.close' | t }}">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M6 18L18 6M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
    </div>
    <div class="mobile-bottom-nav__search-content">
      <form action="{{ routes.search_url }}" method="get" role="search" class="mobile-bottom-nav__search-form">
        <input type="search"
               name="q"
               placeholder="{{ 'general.search.placeholder' | t }}"
               class="mobile-bottom-nav__search-input"
               aria-label="{{ 'general.search.search' | t }}"
               autocomplete="off">
        <button type="submit" class="mobile-bottom-nav__search-submit">
          {{ 'general.search.submit' | t }}
        </button>
      </form>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const searchTrigger = document.querySelector('[data-search-trigger]');
    const searchModal = document.querySelector('[data-search-modal]');
    const searchClose = document.querySelector('[data-search-close]');
    const searchInput = document.querySelector('.mobile-bottom-nav__search-input');
    
    if (searchTrigger && searchModal) {
      searchTrigger.addEventListener('click', function() {
        searchModal.classList.add('is-open');
        document.body.style.overflow = 'hidden';
        if (searchInput) searchInput.focus();
      });
      
      if (searchClose) {
        searchClose.addEventListener('click', function() {
          searchModal.classList.remove('is-open');
          document.body.style.overflow = '';
        });
      }
      
      searchModal.addEventListener('click', function(e) {
        if (e.target === searchModal) {
          searchModal.classList.remove('is-open');
          document.body.style.overflow = '';
        }
      });
    }
  });
</script>
{%- endif -%}

{% schema %}
{
  "name": "Mobile Bottom Navigation",
  "tag": "section",
  "class": "mobile-bottom-navigation",
  "settings": [
    {
      "type": "header",
      "content": "Bottom Navigation Settings"
    },
    {
      "type": "checkbox",
      "id": "enable_bottom_nav",
      "label": "Enable Bottom Navigation",
      "default": true
    },
    {
      "type": "header",
      "content": "Labels"
    },
    {
      "type": "text",
      "id": "home_label",
      "label": "Home Label",
      "default": "Home"
    },
    {
      "type": "text",
      "id": "search_label",
      "label": "Search Label",
      "default": "Search"
    },
    {
      "type": "text",
      "id": "cart_label",
      "label": "Cart Label",
      "default": "Cart"
    },
    {
      "type": "text",
      "id": "account_label",
      "label": "Account Label",
      "default": "Account"
    },
    {
      "type": "header",
      "content": "Style Settings"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#666666"
    },
    {
      "type": "color",
      "id": "active_color",
      "label": "Active Color",
      "default": "#1a365d"
    },
    {
      "type": "color",
      "id": "badge_color",
      "label": "Badge Color",
      "default": "#ef4444"
    }
  ]
}
{% endschema %}
